function GrabzIt(t){return new function(t){this.key=t,this.data=null,this.dataKey=null,this.options=null,this.post=!1,this.elem=null,this.protocol=null,this.ConvertURL=function(t,e){return this.data=t,this.dataKey="url",this.options=this._cleanOptions(e),this.post=!1,this},this.ConvertHTML=function(t,e){return this.data=encodeURIComponent(t),this.dataKey="html",this.options=this._cleanOptions(e),this.post=!0,this},this.UseSSL=function(){return this.protocol="https://",this},this._cleanOptions=function(t){if(null==t)return{};var e={};for(var i in t)null!=i&&(e[i.toLowerCase()]=t[i]);return e},this._createXHTTP=function(){return window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},this._post=function(t){var e=this._createXHTTP(),i=this;e.onreadystatechange=function(){4==this.readyState&&200==this.status&&i.elem.appendChild(i._handlePost(JSON.parse(this.responseText)))},e.open("POST",this._getBaseWebServiceUrl(),!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.send(t)},this._getRootURL=function(){return null==this.protocol&&(this.protocol="//","https:"!=window.location.protocol&&"http:"!=window.location.protocol&&(this.protocol="http://")),this.protocol+"api.grabz.it/services/"},this._getBaseWebServiceUrl=function(){return this._getRootURL()+"javascript.ashx"},this._createQueryString=function(t,e){var i="key="+encodeURIComponent(this.key)+"&"+t+"="+encodeURIComponent(e);for(var n in this.options){if("format"!=n&&"cache"!=n&&"customwatermarkid"!=n&&"quality"!=n&&"country"!=n&&"filename"!=n&&"errorid"!=n&&"errorclass"!=n&&"onfinish"!=n&&"onerror"!=n&&"delay"!=n&&"bwidth"!=n&&"bheight"!=n&&"height"!=n&&"width"!=n&&"target"!=n&&"requestas"!=n&&"download"!=n&&"suppresserrors"!=n&&"displayid"!=n&&"displayclass"!=n&&"background"!=n&&"pagesize"!=n&&"orientation"!=n&&"includelinks"!=n&&"includeoutline"!=n&&"title"!=n&&"coverurl"!=n&&"mtop"!=n&&"mleft"!=n&&"mbottom"!=n&&"mright"!=n&&"tabletoinclude"!=n&&"includeheadernames"!=n&&"includealltables"!=n&&"start"!=n&&"duration"!=n&&"speed"!=n&&"fps"!=n&&"repeat"!=n&&"reverse"!=n&&"templateid"!=n&&"noresult"!=n&&"hide"!=n&&"includeimages"!=n&&"export"!=n&&"waitfor"!=n&&"transparent"!=n)throw"Option "+n+" not recognized!";var o=this.options[n];null!=o&&(i+="&"+n+"="+encodeURIComponent(o))}return i},this._createScriptNode=function(t){var e=document.createElement("script");return e.src=t,e},this._handlePost=function(t){if(null!=t){if(null==t.ID||""==t.ID)throw t.Message;return this._createScriptNode(this._getBaseWebServiceUrl()+"?"+this._createQueryString("id",t.ID))}},this.DataURI=function(t){var e=null;null!=this.options.onfinish&&(e=this.options.onfinish);var i="grabzItCallback"+Math.floor(Math.random()*(1e9+1));this.options.onfinish=i,this.options.noresult=1;var n=this;window[i]=function(i){var o=n._createXHTTP();o.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var n=new FileReader;n.onload=function(n){null!=t&&t(n.target.result),null!=e&&new Function(e+"('"+i+"')")()},n.readAsDataURL(this.response)}},o.open("GET",n._getRootURL()+"getjspicture.ashx?id="+i,!0),o.responseType="blob",o.send()},this.Create()},this.Create=function(){var t=document.documentElement;null!=document.body&&(t=document.body),this.AddTo(t)},this.AddTo=function(t){if("string"==typeof t||t instanceof String){if(this.elem=document.getElementById(t),null==this.elem)throw"An element with the id "+t+" was not found"}else 1===t.nodeType&&(this.elem=t);if(null==this.elem)throw"No valid element was provided to attach the capture to";"1"!=this.options.download&&delete this.options.download,this.post?this._post(this._createQueryString(this.dataKey,this.data)):this.elem.appendChild(this._createScriptNode(this._getBaseWebServiceUrl()+"?"+this._createQueryString(this.dataKey,this.data)))}}(t)}